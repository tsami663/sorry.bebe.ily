<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="A heartfelt apology page with interactive elements and media." />
  <meta name="theme-color" content="#ffccff" />
  <title>I'm Sorry, Love!</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    /* Reset default styles for consistency */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to bottom, #ffccff, #ff99cc);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      color: #333;
      text-align: center;
      overflow-x: hidden;
    }

    h1 {
      font-size: 2.5rem;
      color: #ff4d94;
      text-shadow: 2px 2px #fff;
      animation: pulse 2s ease-in-out infinite;
      margin-bottom: 1rem;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .apology-text {
      font-size: 1.2rem;
      margin: 1rem;
      padding: 1rem;
      background: #fff;
      border-radius: 10px;
      border: 2px solid #ff4d94;
      max-width: 90%;
      width: 500px;
      transition: background-color 0.3s ease;
    }

    .apology-text:focus {
      outline: 2px solid #ff3399;
    }

    .media-container {
      display: flex;
      gap: 1rem;
      margin: 1rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    img,
    video {
      max-width: 300px;
      width: 100%;
      border-radius: 15px;
      border: 3px solid #ff66b2;
      object-fit: cover;
    }

    button {
      font-size: 1.5rem;
      padding: 0.75rem 1.5rem;
      background: #ff66b2;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease, font-size 0.2s ease;
    }

    button:hover,
    button:focus {
      background: #ff3399;
      transform: scale(1.05);
      outline: none;
    }

    button:focus {
      outline: 2px solid #fff;
    }

    .annoying {
      animation: shake 0.5s ease-in-out infinite;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      padding: 1rem;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      background: #fff;
      padding: 1.5rem;
      border-radius: 15px;
      border: 3px solid #ff4d94;
      max-width: 90%;
      max-height: 90vh;
      width: 600px;
      text-align: center;
      position: relative;
      overflow-y: auto;
      animation: slideIn 0.3s ease-in-out;
    }

    @keyframes slideIn {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-title {
      font-size: 1.8rem;
      color: #ff4d94;
      margin-bottom: 1rem;
    }

    .modal-content img {
      max-width: 200px;
      width: 100%;
      margin-bottom: 1rem;
    }

    .modal-content p {
      font-size: 1.1rem;
      color: #333;
      text-align: left;
      line-height: 1.6;
    }

    .close-button {
      font-size: 1.5rem;
      color: #ff4d94;
      cursor: pointer;
      position: absolute;
      top: 0.75rem;
      right: 1rem;
      background: none;
      border: none;
      transition: color 0.3s ease;
    }

    .close-button:hover,
    .close-button:focus {
      color: #ff3399;
      outline: none;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 2rem;
      }

      .apology-text {
        font-size: 1rem;
        padding: 0.75rem;
      }

      button {
        font-size: 1.2rem;
        padding: 0.5rem 1rem;
      }

      .modal-content {
        padding: 1rem;
      }

      .modal-content img {
        max-width: 100%;
      }

      .modal-content p {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <h1>I'm So Sorry, My Love! ðŸ˜­</h1>

  <div class="apology-text" id="apologyText" role="alert">
    Bebe, sorry jud kaayo ko kung napasakitan tika og nagkulang ko. ðŸ¥ºðŸ’•
  </div>

  <div class="media-container">
    <img src="./images/528167571_2652069641804306_17602123091706032_n.jpg" alt="Cute heart illustration" loading="lazy" />
    <video controls preload="metadata" aria-label="Apology video">
      <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4" />
      Your browser does not support the video tag.
    </video>
  </div>

  <button id="sorryButton" type="button" aria-label="Request forgiveness">Please Forgive Me!</button>

  <div id="surpriseModal" class="modal" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-content">
      <button class="close-button" aria-label="Close modal" type="button">&times;</button>
      <h2 id="modalTitle" class="modal-title">A Special Message</h2>
      <img src="./images/517940061_707878778738143_4701373330975798104_n.jpg" alt="Photo of us together" loading="lazy" />
      <p>
        I'm sorry, bebe. Maybe it's unusual for you that I'm sending this, especially since it's not our monthsary. To be honest, Iâ€™ve always wanted to give you something on July 7, our monthsary. I was thinking of making you a handmade gift for a change of pace, like cards with photos of us attachedâ€”something along those lines (pero naunhan man ko nimo, bebe. Embarrassing siya, pero na-appreciate nako to be hehe). Hahaha. But I didnâ€™t make it because si ams has no sense of privacy, and she would just go through things without asking us first. So from now on, I'll just stick to making stuff like this, and I really hope you appreciate it. At the same time, Iâ€™m not confident I can make a letter since, well, I'm not really great at expressing my feelings verbally.

        So, uhm, I'm sorry if our time to interact has lessened, which caused us to argue. Sorry, bebe, and thank you ðŸ¤Ÿ
      </p>
    </div>
  </div>

  <audio id="confettiSound" src="./confetti-pop-sound-effect.mp3" preload="auto" aria-hidden="true"></audio>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js" integrity="sha256-JW2Y5tXsyPyH6sE++J2D54LKrLyj3tiT3kwT8S12nK0=" crossorigin="anonymous"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const button = document.getElementById('sorryButton');
      const apologyText = document.getElementById('apologyText');
      const modal = document.getElementById('surpriseModal');
      const closeButton = document.querySelector('.close-button');
      const confettiSound = document.getElementById('confettiSound');
      let clickCount = 0;

      // Prevent context menu on long press for better touch experience
      button.addEventListener('contextmenu', (e) => e.preventDefault());

      // Handle button clicks
      button.addEventListener('click', () => {
        clickCount++;
        const scale = 1 + clickCount * 0.1;
        button.style.transform = `scale(${scale})`;
        button.style.fontSize = `${1.5 + clickCount * 0.15}rem`;
        button.classList.add('annoying');

        if (clickCount === 3) {
          apologyText.textContent = "I'm REALLY sorry! ðŸ’”";
        } else if (clickCount === 5) {
          apologyText.textContent = "I'M BEGGING YOU! Forgive me, my one and only! ðŸ˜­ðŸ˜­";
        } else if (clickCount >= 7) {
          apologyText.textContent = "I hope you forgive me, sorry, and I love u bebe xoxo! ðŸ¥°";
          button.textContent = "I LOVE YOU FOREVER!";
          button.setAttribute('aria-disabled', 'true');
          button.disabled = true;
          showModalWithEffects();
        }
      });

      // Handle keyboard interaction
      button.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          button.click();
        }
      });

      function showModalWithEffects() {
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden', 'false');
        confettiSound.volume = 0.8;
        confettiSound.currentTime = 0;
        confettiSound.play().catch((e) => console.log("Audio autoplay issue:", e));

        confetti({
          particleCount: 150,
          spread: 120,
          origin: { y: 0.5 },
          colors: ['#ff4d94', '#ff66b2', '#ff99cc'],
        });
      }

      function closeModal() {
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
      }

      // Close modal on click outside
      modal.addEventListener('click', (event) => {
        if (event.target === modal) {
          closeModal();
        }
      });

      // Close modal on Escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.style.display === 'flex') {
          closeModal();
        }
      });

      // Close modal with close button
      closeButton.addEventListener('click', closeModal);

      // Prevent default touch scrolling when modal is open
      modal.addEventListener('touchmove', (e) => {
        if (modal.style.display === 'flex') {
          e.preventDefault();
        }
      });
    });
  </script>
</body>
</html>
